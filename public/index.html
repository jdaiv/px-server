<!doctype HTML>
<html>

    <head>
        <title></title>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>

    <body>
        <div id="login"></div>

        <form id="sendForm">
            <input id="input" autocomplete="off"><input type="submit" value="Send">
        </form>
        <div id="ws_debug"></div>
        <pre id="log"></pre>

        <script src="state.js"></script>
        <script src="components.js"></script>
        <script src="ws.js"></script>
        <script>
            const state = new StateManager()
            const events = new EventManager()
            const connector = new Connector()
            connector.open()

            const log = document.getElementById('log')
            const input = document.getElementById('input')
            const form = document.getElementById('sendForm')

            events.subscribe('ws_debug', 'msg_log', (data) => {
                if (data) log.innerHTML += JSON.stringify(data) + '\n'
            })

            new C_ConnectorStatus(document.getElementById('ws_debug'))
            new C_AuthBox(document.getElementById('login'))

            form.onsubmit = (evt) => {
                if (connector) {
                    connector.send(input.value)
                    return false
                }
            }
        </script>
    </body>

</html>